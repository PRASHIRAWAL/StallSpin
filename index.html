<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CESA | Spin the Wheel</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

        :root {
            --background-color: #121212;
            --primary-purple: #9b59b6;
            --light-purple: #af7ac5;
            --dark-purple: #8e44ad;
            --text-color: #ffffff;
            --shadow-color: rgba(155, 89, 182, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            /* ENHANCEMENT: Added an animated gradient background */
            background: linear-gradient(-45deg, #1a1a1a, #2c1a3b, #1a1a1a, #3b1a2c);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .logo {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 100px;
            height: auto;
            opacity: 0.8;
        }

        .container {
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--light-purple);
            text-shadow: 0 0 10px var(--shadow-color);
        }

        .wheel-container {
            position: relative;
            width: 500px;
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pointer {
            position: absolute;
            top: -15px; /* Adjusted position */
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            /* ENHANCEMENT: Made the pointer more distinct */
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 50px solid var(--primary-purple);
            z-index: 10;
            filter: drop-shadow(0 -5px 5px rgba(0,0,0,0.3));
        }

        #wheelCanvas {
            transition: transform 5s cubic-bezier(0.25, 0.1, 0.25, 1);
            max-width: 100%;
            border-radius: 50%;
            box-shadow: 0 0 30px var(--shadow-color), inset 0 0 20px rgba(0,0,0,0.5);
        }

        #spinBtn {
            margin-top: 30px;
            padding: 15px 40px;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color);
            background-color: var(--primary-purple);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px var(--shadow-color);
        }

        #spinBtn:hover:not(:disabled) {
            background-color: var(--light-purple);
            /* ENHANCEMENT: Added a glow effect on hover */
            box-shadow: 0 8px 25px var(--shadow-color), 0 0 20px var(--light-purple);
            transform: translateY(-3px);
        }

        #spinBtn:active:not(:disabled) {
            transform: scale(0.95) translateY(0);
        }

        #spinBtn:disabled {
            background-color: #555;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background-color: #2c2c2c;
            margin: 15% auto;
            padding: 30px;
            border: 2px solid var(--primary-purple);
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            position: relative;
            /* ENHANCEMENT: New modal animation */
            animation: zoomBounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 25px var(--shadow-color);
        }

        .close-btn {
            color: #aaa;
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: var(--text-color);
        }
        
        .modal-content h2 {
            color: var(--text-color);
        }

        #dareText {
            font-size: 1.3rem;
            margin-top: 15px;
            color: var(--light-purple);
            font-weight: 600;
            line-height: 1.6;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ENHANCEMENT: New animation for the modal */
        @keyframes zoomBounceIn {
            0% {
                transform: scale(0.5) translateY(-50px);
                opacity: 0;
            }
            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <header>
        <img src="logo.png" alt="CESA Logo" class="logo">
    </header>

    <div class="container">
        <h1>Spin the Wheel of Dares</h1>
        <div class="wheel-container">
            <div class="pointer"></div>
            <canvas id="wheelCanvas" width="500" height="500"></canvas>
        </div>
        <button id="spinBtn">SPIN!</button>
    </div>

    <div id="dareModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Your Dare Is...</h2>
            <p id="dareText"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('wheelCanvas');
            const spinBtn = document.getElementById('spinBtn');
            const modal = document.getElementById('dareModal');
            const dareText = document.getElementById('dareText');
            const closeBtn = document.querySelector('.close-btn');
            const ctx = canvas.getContext('2d');

            // --- Configuration ---
            const segments = [
                { color: '#8e44ad', label: 'Dare 1' },
                { color: '#9b59b6', label: 'Dare 2' },
                { color: '#8e44ad', label: 'Dare 3' },
                { color: '#9b59b6', label: 'Dare 4' },
                { color: '#8e44ad', label: 'Dare 5' },
                { color: '#9b59b6', label: 'Dare 6' },
                { color: '#8e44ad', label: 'Dare 7' },
                { color: '#9b59b6', label: 'Dare 8' },
            ];

            const dares = [
                "Sing the chorus of your favorite song out loud.",
                "Do 10 push-ups right now.",
                "Speak in an accent for the next 5 minutes.",
                "Let someone else post a status on your social media.",
                "Do your best impression of a celebrity.",
                "Hold a plank for 30 seconds.",
                "Tell a cheesy joke to the group.",
                "Show the most embarrassing photo on your phone."
            ];
            // ---------------------

            const numSegments = segments.length;
            const arcSize = (2 * Math.PI) / numSegments;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2 - 5; // leave space for border

            let currentRotation = 0;
            let isSpinning = false;

            const drawWheel = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                segments.forEach((segment, i) => {
                    const angle = i * arcSize;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, angle, angle + arcSize);
                    ctx.closePath();
                    ctx.fillStyle = segment.color;
                    ctx.fill();
                    
                    // Draw text
                    ctx.save();
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 18px Poppins';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    const textAngle = angle + arcSize / 2;
                    ctx.translate(centerX, centerY);
                    ctx.rotate(textAngle);
                    ctx.fillText(segment.label, radius * 0.65, 0);
                    ctx.restore();
                });

                // ENHANCEMENT: Add center hub and border
                // Outer Border
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 5;
                ctx.stroke();

                // Center Hub
                ctx.beginPath();
                ctx.arc(centerX, centerY, 20, 0, 2 * Math.PI);
                ctx.fillStyle = '#444';
                ctx.fill();
                ctx.beginPath();
                ctx.arc(centerX, centerY, 15, 0, 2 * Math.PI);
                ctx.fillStyle = '#fff';
                ctx.fill();
            };

            const spin = () => {
                if (isSpinning) return;
                isSpinning = true;
                spinBtn.disabled = true;

                const randomSpins = Math.floor(Math.random() * 5) + 5; // 5 to 9 full rotations
                const randomAngle = Math.random() * 360; // Random stopping point
                const totalRotation = randomSpins * 360 + randomAngle;

                currentRotation += totalRotation;
                canvas.style.transform = `rotate(${currentRotation}deg)`;
            };

            canvas.addEventListener('transitionend', () => {
                isSpinning = false;
                spinBtn.disabled = false;

                const actualRotation = currentRotation % 360;
                const segmentAngleDegrees = 360 / numSegments;
                
                // Adjust for pointer being at the top (canvas 0deg is East, CSS 0deg is North)
                const winningIndex = Math.floor((360 - actualRotation + 90 + segmentAngleDegrees / 2) % 360 / segmentAngleDegrees);
                
                showDare(winningIndex);
            });

            const showDare = (index) => {
                dareText.textContent = dares[index] || "No dare found!";
                modal.style.display = 'block';
            };

            const hideDare = () => {
                modal.style.display = 'none';
            };

            spinBtn.addEventListener('click', spin);
            closeBtn.addEventListener('click', hideDare);
            
            window.addEventListener('click', (event) => {
                if (event.target === modal) {
                    hideDare();
                }
            });

            // NEW: Add spacebar functionality
            window.addEventListener('keydown', (event) => {
                // Check if spacebar is pressed, wheel is not spinning, and modal is not open
                if (event.key === ' ' && !isSpinning && modal.style.display !== 'block') {
                    event.preventDefault(); // Prevent default spacebar action (like scrolling)
                    spin();
                }
            });

            drawWheel(); // Initial draw
        });
    </script>
</body>
</html>
